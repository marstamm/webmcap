(()=>{var Wr=Object.create;var De=Object.defineProperty;var Dr=Object.getOwnPropertyDescriptor;var Vr=Object.getOwnPropertyNames,qi=Object.getOwnPropertySymbols,Ur=Object.getPrototypeOf,Fi=Object.prototype.hasOwnProperty,Br=Object.prototype.propertyIsEnumerable;var $i=(a,s,o)=>s in a?De(a,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[s]=o,Ve=(a,s)=>{for(var o in s||(s={}))Fi.call(s,o)&&$i(a,o,s[o]);if(qi)for(var o of qi(s))Br.call(s,o)&&$i(a,o,s[o]);return a};var Nr=a=>De(a,"__esModule",{value:!0});var N=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports);var qr=(a,s,o)=>{if(s&&typeof s=="object"||typeof s=="function")for(let u of Vr(s))!Fi.call(a,u)&&u!=="default"&&De(a,u,{get:()=>s[u],enumerable:!(o=Dr(s,u))||o.enumerable});return a},gt=a=>qr(Nr(De(a!=null?Wr(Ur(a)):{},"default",a&&a.__esModule&&"default"in a?{get:()=>a.default,enumerable:!0}:{value:a,enumerable:!0})),a);var _t=N((ws,ji)=>{"use strict";function $t(a,s,o,u,M,g){return{tag:a,key:s,attrs:o,children:u,text:M,dom:g,domSize:void 0,state:void 0,events:void 0,instance:void 0}}$t.normalize=function(a){return Array.isArray(a)?$t("[",void 0,void 0,$t.normalizeChildren(a),void 0,void 0):a==null||typeof a=="boolean"?null:typeof a=="object"?a:$t("#",void 0,void 0,String(a),void 0,void 0)};$t.normalizeChildren=function(a){var s=[];if(a.length){for(var o=a[0]!=null&&a[0].key!=null,u=1;u<a.length;u++)if((a[u]!=null&&a[u].key!=null)!==o)throw new TypeError("Vnodes must either always have keys or never have keys!");for(var u=0;u<a.length;u++)s[u]=$t.normalize(a[u])}return s};ji.exports=$t});var yi=N((ys,Hi)=>{"use strict";var Fr=_t();Hi.exports=function(){var a=arguments[this],s=this+1,o;if(a==null?a={}:(typeof a!="object"||a.tag!=null||Array.isArray(a))&&(a={},s=this),arguments.length===s+1)o=arguments[s],Array.isArray(o)||(o=[o]);else for(o=[];s<arguments.length;)o.push(arguments[s++]);return Fr("",a.key,a,o)}});var bi=N((bs,Yi)=>{"use strict";var Ki=_t(),$r=yi(),jr=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,Gi={},ne={}.hasOwnProperty;function Xi(a){for(var s in a)if(ne.call(a,s))return!1;return!0}function Hr(a){for(var s,o="div",u=[],M={};s=jr.exec(a);){var g=s[1],m=s[2];if(g===""&&m!=="")o=m;else if(g==="#")M.id=m;else if(g===".")u.push(m);else if(s[3][0]==="["){var w=s[6];w&&(w=w.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),s[4]==="class"?u.push(w):M[s[4]]=w===""?w:w||!0}}return u.length>0&&(M.className=u.join(" ")),Gi[a]={tag:o,attrs:M}}function Kr(a,s){var o=s.attrs,u=Ki.normalizeChildren(s.children),M=ne.call(o,"class"),g=M?o.class:o.className;if(s.tag=a.tag,s.attrs=null,s.children=void 0,!Xi(a.attrs)&&!Xi(o)){var m={};for(var w in o)ne.call(o,w)&&(m[w]=o[w]);o=m}for(var w in a.attrs)ne.call(a.attrs,w)&&w!=="className"&&!ne.call(o,w)&&(o[w]=a.attrs[w]);(g!=null||a.attrs.className!=null)&&(o.className=g!=null?a.attrs.className!=null?String(a.attrs.className)+" "+String(g):g:a.attrs.className!=null?a.attrs.className:null),M&&(o.class=null);for(var w in o)if(ne.call(o,w)&&w!=="key"){s.attrs=o;break}return Array.isArray(u)&&u.length===1&&u[0]!=null&&u[0].tag==="#"?s.text=u[0].children:s.children=u,s}function Gr(a){if(a==null||typeof a!="string"&&typeof a!="function"&&typeof a.view!="function")throw Error("The selector must be either a string or a component.");var s=$r.apply(1,arguments);return typeof a=="string"&&(s.children=Ki.normalizeChildren(s.children),a!=="[")?Kr(Gi[a]||Hr(a),s):(s.tag=a,s)}Yi.exports=Gr});var Ji=N((vs,Qi)=>{"use strict";var Xr=_t();Qi.exports=function(a){return a==null&&(a=""),Xr("<",void 0,void 0,a,void 0,void 0)}});var tr=N((Ms,Zi)=>{"use strict";var Yr=_t(),Qr=yi();Zi.exports=function(){var a=Qr.apply(0,arguments);return a.tag="[",a.children=Yr.normalizeChildren(a.children),a}});var ir=N((xs,er)=>{"use strict";var vi=bi();vi.trust=Ji();vi.fragment=tr();er.exports=vi});var Mi=N((_s,rr)=>{"use strict";var J=function(a){if(!(this instanceof J))throw new Error("Promise must be called with `new`");if(typeof a!="function")throw new TypeError("executor must be a function");var s=this,o=[],u=[],M=d(o,!0),g=d(u,!1),m=s._instance={resolvers:o,rejectors:u},w=typeof setImmediate=="function"?setImmediate:setTimeout;function d(C,k){return function T(i){var f;try{if(k&&i!=null&&(typeof i=="object"||typeof i=="function")&&typeof(f=i.then)=="function"){if(i===s)throw new TypeError("Promise can't be resolved w/ itself");x(f.bind(i))}else w(function(){!k&&C.length===0&&console.error("Possible unhandled promise rejection:",i);for(var b=0;b<C.length;b++)C[b](i);o.length=0,u.length=0,m.state=k,m.retry=function(){T(i)}})}catch(b){g(b)}}}function x(C){var k=0;function T(f){return function(b){k++>0||f(b)}}var i=T(g);try{C(T(M),i)}catch(f){i(f)}}x(a)};J.prototype.then=function(a,s){var o=this,u=o._instance;function M(d,x,C,k){x.push(function(T){if(typeof d!="function")C(T);else try{g(d(T))}catch(i){m&&m(i)}}),typeof u.retry=="function"&&k===u.state&&u.retry()}var g,m,w=new J(function(d,x){g=d,m=x});return M(a,u.resolvers,g,!0),M(s,u.rejectors,m,!1),w};J.prototype.catch=function(a){return this.then(null,a)};J.prototype.finally=function(a){return this.then(function(s){return J.resolve(a()).then(function(){return s})},function(s){return J.resolve(a()).then(function(){return J.reject(s)})})};J.resolve=function(a){return a instanceof J?a:new J(function(s){s(a)})};J.reject=function(a){return new J(function(s,o){o(a)})};J.all=function(a){return new J(function(s,o){var u=a.length,M=0,g=[];if(a.length===0)s([]);else for(var m=0;m<a.length;m++)(function(w){function d(x){M++,g[w]=x,M===u&&s(g)}a[w]!=null&&(typeof a[w]=="object"||typeof a[w]=="function")&&typeof a[w].then=="function"?a[w].then(d,o):d(a[w])})(m)})};J.race=function(a){return new J(function(s,o){for(var u=0;u<a.length;u++)a[u].then(s,o)})};rr.exports=J});var xi=N((Cs,Ue)=>{"use strict";var ke=Mi();typeof window!="undefined"?(typeof window.Promise=="undefined"?window.Promise=ke:window.Promise.prototype.finally||(window.Promise.prototype.finally=ke.prototype.finally),Ue.exports=window.Promise):typeof global!="undefined"?(typeof global.Promise=="undefined"?global.Promise=ke:global.Promise.prototype.finally||(global.Promise.prototype.finally=ke.prototype.finally),Ue.exports=global.Promise):Ue.exports=ke});var nr=N((Es,sr)=>{"use strict";var ae=_t();sr.exports=function(a){var s=a&&a.document,o,u={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function M(e){return e.attrs&&e.attrs.xmlns||u[e.tag]}function g(e,t){if(e.state!==t)throw new Error("`vnode.state` must not be modified")}function m(e){var t=e.state;try{return this.apply(t,arguments)}finally{g(e,t)}}function w(){try{return s.activeElement}catch(e){return null}}function d(e,t,n,c,p,_,L){for(var R=n;R<c;R++){var S=t[R];S!=null&&x(e,S,p,L,_)}}function x(e,t,n,c,p){var _=t.tag;if(typeof _=="string")switch(t.state={},t.attrs!=null&&de(t.attrs,t,n),_){case"#":C(e,t,p);break;case"<":T(e,t,c,p);break;case"[":i(e,t,n,c,p);break;default:f(e,t,n,c,p)}else y(e,t,n,c,p)}function C(e,t,n){t.dom=s.createTextNode(t.children),dt(e,t.dom,n)}var k={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function T(e,t,n,c){var p=t.children.match(/^\s*?<(\w+)/im)||[],_=s.createElement(k[p[1]]||"div");n==="http://www.w3.org/2000/svg"?(_.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+t.children+"</svg>",_=_.firstChild):_.innerHTML=t.children,t.dom=_.firstChild,t.domSize=_.childNodes.length,t.instance=[];for(var L=s.createDocumentFragment(),R;R=_.firstChild;)t.instance.push(R),L.appendChild(R);dt(e,L,c)}function i(e,t,n,c,p){var _=s.createDocumentFragment();if(t.children!=null){var L=t.children;d(_,L,0,L.length,n,null,c)}t.dom=_.firstChild,t.domSize=_.childNodes.length,dt(e,_,p)}function f(e,t,n,c,p){var _=t.tag,L=t.attrs,R=L&&L.is;c=M(t)||c;var S=c?R?s.createElementNS(c,_,{is:R}):s.createElementNS(c,_):R?s.createElement(_,{is:R}):s.createElement(_);if(t.dom=S,L!=null&&ue(t,L,c),dt(e,S,p),!ft(t)&&(t.text!=null&&(t.text!==""?S.textContent=t.text:t.children=[ae("#",void 0,void 0,t.text,void 0,void 0)]),t.children!=null)){var W=t.children;d(S,W,0,W.length,n,null,c),t.tag==="select"&&L!=null&&Kt(t,L)}}function b(e,t){var n;if(typeof e.tag.view=="function"){if(e.state=Object.create(e.tag),n=e.state.view,n.$$reentrantLock$$!=null)return;n.$$reentrantLock$$=!0}else{if(e.state=void 0,n=e.tag,n.$$reentrantLock$$!=null)return;n.$$reentrantLock$$=!0,e.state=e.tag.prototype!=null&&typeof e.tag.prototype.view=="function"?new e.tag(e):e.tag(e)}if(de(e.state,e,t),e.attrs!=null&&de(e.attrs,e,t),e.instance=ae.normalize(m.call(e.state.view,e)),e.instance===e)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null}function y(e,t,n,c,p){b(t,n),t.instance!=null?(x(e,t.instance,n,c,p),t.dom=t.instance.dom,t.domSize=t.dom!=null?t.instance.domSize:0):t.domSize=0}function z(e,t,n,c,p,_){if(!(t===n||t==null&&n==null))if(t==null||t.length===0)d(e,n,0,n.length,c,p,_);else if(n==null||n.length===0)it(e,t,0,t.length);else{var L=t[0]!=null&&t[0].key!=null,R=n[0]!=null&&n[0].key!=null,S=0,W=0;if(!L)for(;W<t.length&&t[W]==null;)W++;if(!R)for(;S<n.length&&n[S]==null;)S++;if(R===null&&L==null)return;if(L!==R)it(e,t,W,t.length),d(e,n,S,n.length,c,p,_);else if(R){for(var G=t.length-1,j=n.length-1,Xt,F,V,Q,U,Bt;G>=W&&j>=S&&(Q=t[G],U=n[j],Q.key===U.key);)Q!==U&&$(e,Q,U,c,p,_),U.dom!=null&&(p=U.dom),G--,j--;for(;G>=W&&j>=S&&(F=t[W],V=n[S],F.key===V.key);)W++,S++,F!==V&&$(e,F,V,c,K(t,W,p),_);for(;G>=W&&j>=S&&!(S===j||F.key!==U.key||Q.key!==V.key);)Bt=K(t,W,p),O(e,Q,Bt),Q!==V&&$(e,Q,V,c,Bt,_),++S<=--j&&O(e,F,p),F!==U&&$(e,F,U,c,p,_),U.dom!=null&&(p=U.dom),W++,G--,Q=t[G],U=n[j],F=t[W],V=n[S];for(;G>=W&&j>=S&&Q.key===U.key;)Q!==U&&$(e,Q,U,c,p,_),U.dom!=null&&(p=U.dom),G--,j--,Q=t[G],U=n[j];if(S>j)it(e,t,W,G+1);else if(W>G)d(e,n,S,j+1,c,p,_);else{var Yt=p,we=j-S+1,Ot=new Array(we),Qt=0,B=0,P=2147483647,A=0,Xt,vt;for(B=0;B<we;B++)Ot[B]=-1;for(B=j;B>=S;B--){Xt==null&&(Xt=st(t,W,G+1)),U=n[B];var ot=Xt[U.key];ot!=null&&(P=ot<P?ot:-1,Ot[B-S]=ot,Q=t[ot],t[ot]=null,Q!==U&&$(e,Q,U,c,p,_),U.dom!=null&&(p=U.dom),A++)}if(p=Yt,A!==G-W+1&&it(e,t,W,G+1),A===0)d(e,n,S,j+1,c,p,_);else if(P===-1)for(vt=mt(Ot),Qt=vt.length-1,B=j;B>=S;B--)V=n[B],Ot[B-S]===-1?x(e,V,c,_,p):vt[Qt]===B-S?Qt--:O(e,V,p),V.dom!=null&&(p=n[B].dom);else for(B=j;B>=S;B--)V=n[B],Ot[B-S]===-1&&x(e,V,c,_,p),V.dom!=null&&(p=n[B].dom)}}else{var bt=t.length<n.length?t.length:n.length;for(S=S<W?S:W;S<bt;S++)F=t[S],V=n[S],!(F===V||F==null&&V==null)&&(F==null?x(e,V,c,_,K(t,S+1,p)):V==null?kt(e,F):$(e,F,V,c,K(t,S+1,p),_));t.length>bt&&it(e,t,S,t.length),n.length>bt&&d(e,n,S,n.length,c,p,_)}}}function $(e,t,n,c,p,_){var L=t.tag,R=n.tag;if(L===R){if(n.state=t.state,n.events=t.events,Ut(n,t))return;if(typeof L=="string")switch(n.attrs!=null&&ge(n.attrs,n,c),L){case"#":ct(t,n);break;case"<":pt(e,t,n,_,p);break;case"[":H(e,t,n,c,p,_);break;default:I(t,n,c,_)}else Y(e,t,n,c,p,_)}else kt(e,t),x(e,n,c,_,p)}function ct(e,t){e.children.toString()!==t.children.toString()&&(e.dom.nodeValue=t.children),t.dom=e.dom}function pt(e,t,n,c,p){t.children!==n.children?(fe(e,t),T(e,n,c,p)):(n.dom=t.dom,n.domSize=t.domSize,n.instance=t.instance)}function H(e,t,n,c,p,_){z(e,t.children,n.children,c,p,_);var L=0,R=n.children;if(n.dom=null,R!=null){for(var S=0;S<R.length;S++){var W=R[S];W!=null&&W.dom!=null&&(n.dom==null&&(n.dom=W.dom),L+=W.domSize||1)}L!==1&&(n.domSize=L)}}function I(e,t,n,c){var p=t.dom=e.dom;c=M(t)||c,t.tag==="textarea"&&(t.attrs==null&&(t.attrs={}),t.text!=null&&(t.attrs.value=t.text,t.text=void 0)),yt(t,e.attrs,t.attrs,c),ft(t)||(e.text!=null&&t.text!=null&&t.text!==""?e.text.toString()!==t.text.toString()&&(e.dom.firstChild.nodeValue=t.text):(e.text!=null&&(e.children=[ae("#",void 0,void 0,e.text,void 0,e.dom.firstChild)]),t.text!=null&&(t.children=[ae("#",void 0,void 0,t.text,void 0,void 0)]),z(p,e.children,t.children,n,null,c)))}function Y(e,t,n,c,p,_){if(n.instance=ae.normalize(m.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");ge(n.state,n,c),n.attrs!=null&&ge(n.attrs,n,c),n.instance!=null?(t.instance==null?x(e,n.instance,c,_,p):$(e,t.instance,n.instance,c,p,_),n.dom=n.instance.dom,n.domSize=n.instance.domSize):t.instance!=null?(kt(e,t.instance),n.dom=void 0,n.domSize=0):(n.dom=t.dom,n.domSize=t.domSize)}function st(e,t,n){for(var c=Object.create(null);t<n;t++){var p=e[t];if(p!=null){var _=p.key;_!=null&&(c[_]=t)}}return c}var Z=[];function mt(e){for(var t=[0],n=0,c=0,p=0,_=Z.length=e.length,p=0;p<_;p++)Z[p]=e[p];for(var p=0;p<_;++p)if(e[p]!==-1){var L=t[t.length-1];if(e[L]<e[p]){Z[p]=L,t.push(p);continue}for(n=0,c=t.length-1;n<c;){var R=(n>>>1)+(c>>>1)+(n&c&1);e[t[R]]<e[p]?n=R+1:c=R}e[p]<e[t[n]]&&(n>0&&(Z[p]=t[n-1]),t[n]=p)}for(n=t.length,c=t[n-1];n-- >0;)t[n]=c,c=Z[c];return Z.length=0,t}function K(e,t,n){for(;t<e.length;t++)if(e[t]!=null&&e[t].dom!=null)return e[t].dom;return n}function O(e,t,n){var c=s.createDocumentFragment();Et(e,c,t),dt(e,c,n)}function Et(e,t,n){for(;n.dom!=null&&n.dom.parentNode===e;){if(typeof n.tag!="string"){if(n=n.instance,n!=null)continue}else if(n.tag==="<")for(var c=0;c<n.instance.length;c++)t.appendChild(n.instance[c]);else if(n.tag!=="[")t.appendChild(n.dom);else if(n.children.length===1){if(n=n.children[0],n!=null)continue}else for(var c=0;c<n.children.length;c++){var p=n.children[c];p!=null&&Et(e,t,p)}break}}function dt(e,t,n){n!=null?e.insertBefore(t,n):e.appendChild(t)}function ft(e){if(e.attrs==null||e.attrs.contenteditable==null&&e.attrs.contentEditable==null)return!1;var t=e.children;if(t!=null&&t.length===1&&t[0].tag==="<"){var n=t[0].children;e.dom.innerHTML!==n&&(e.dom.innerHTML=n)}else if(e.text!=null||t!=null&&t.length!==0)throw new Error("Child node of a contenteditable must be trusted");return!0}function it(e,t,n,c){for(var p=n;p<c;p++){var _=t[p];_!=null&&kt(e,_)}}function kt(e,t){var n=0,c=t.state,p,_;if(typeof t.tag!="string"&&typeof t.state.onbeforeremove=="function"){var L=m.call(t.state.onbeforeremove,t);L!=null&&typeof L.then=="function"&&(n=1,p=L)}if(t.attrs&&typeof t.attrs.onbeforeremove=="function"){var L=m.call(t.attrs.onbeforeremove,t);L!=null&&typeof L.then=="function"&&(n|=2,_=L)}if(g(t,c),!n)St(t),Tt(e,t);else{if(p!=null){var R=function(){n&1&&(n&=2,n||S())};p.then(R,R)}if(_!=null){var R=function(){n&2&&(n&=1,n||S())};_.then(R,R)}}function S(){g(t,c),St(t),Tt(e,t)}}function fe(e,t){for(var n=0;n<t.instance.length;n++)e.removeChild(t.instance[n])}function Tt(e,t){for(;t.dom!=null&&t.dom.parentNode===e;){if(typeof t.tag!="string"){if(t=t.instance,t!=null)continue}else if(t.tag==="<")fe(e,t);else{if(t.tag!=="["&&(e.removeChild(t.dom),!Array.isArray(t.children)))break;if(t.children.length===1){if(t=t.children[0],t!=null)continue}else for(var n=0;n<t.children.length;n++){var c=t.children[n];c!=null&&Tt(e,c)}}break}}function St(e){if(typeof e.tag!="string"&&typeof e.state.onremove=="function"&&m.call(e.state.onremove,e),e.attrs&&typeof e.attrs.onremove=="function"&&m.call(e.attrs.onremove,e),typeof e.tag!="string")e.instance!=null&&St(e.instance);else{var t=e.children;if(Array.isArray(t))for(var n=0;n<t.length;n++){var c=t[n];c!=null&&St(c)}}}function ue(e,t,n){for(var c in t)Ht(e,c,null,t[c],n)}function Ht(e,t,n,c,p){if(!(t==="key"||t==="is"||c==null||At(t)||n===c&&!Wt(e,t)&&typeof c!="object")){if(t[0]==="o"&&t[1]==="n")return me(e,t,c);if(t.slice(0,6)==="xlink:")e.dom.setAttributeNS("http://www.w3.org/1999/xlink",t.slice(6),c);else if(t==="style")Vt(e.dom,n,c);else if(Gt(e,t,p)){if(t==="value"&&((e.tag==="input"||e.tag==="textarea")&&e.dom.value===""+c&&e.dom===w()||e.tag==="select"&&n!==null&&e.dom.value===""+c||e.tag==="option"&&n!==null&&e.dom.value===""+c))return;e.tag==="input"&&t==="type"?e.dom.setAttribute(t,c):e.dom[t]=c}else typeof c=="boolean"?c?e.dom.setAttribute(t,""):e.dom.removeAttribute(t):e.dom.setAttribute(t==="className"?"class":t,c)}}function pe(e,t,n,c){if(!(t==="key"||t==="is"||n==null||At(t)))if(t[0]==="o"&&t[1]==="n"&&!At(t))me(e,t,void 0);else if(t==="style")Vt(e.dom,n,null);else if(Gt(e,t,c)&&t!=="className"&&!(t==="value"&&(e.tag==="option"||e.tag==="select"&&e.dom.selectedIndex===-1&&e.dom===w()))&&!(e.tag==="input"&&t==="type"))e.dom[t]=null;else{var p=t.indexOf(":");p!==-1&&(t=t.slice(p+1)),n!==!1&&e.dom.removeAttribute(t==="className"?"class":t)}}function Kt(e,t){if("value"in t)if(t.value===null)e.dom.selectedIndex!==-1&&(e.dom.value=null);else{var n=""+t.value;(e.dom.value!==n||e.dom.selectedIndex===-1)&&(e.dom.value=n)}"selectedIndex"in t&&Ht(e,"selectedIndex",null,t.selectedIndex,void 0)}function yt(e,t,n,c){if(n!=null)for(var p in n)Ht(e,p,t&&t[p],n[p],c);var _;if(t!=null)for(var p in t)(_=t[p])!=null&&(n==null||n[p]==null)&&pe(e,p,_,c)}function Wt(e,t){return t==="value"||t==="checked"||t==="selectedIndex"||t==="selected"&&e.dom===w()||e.tag==="option"&&e.dom.parentNode===s.activeElement}function At(e){return e==="oninit"||e==="oncreate"||e==="onupdate"||e==="onremove"||e==="onbeforeremove"||e==="onbeforeupdate"}function Gt(e,t,n){return n===void 0&&(e.tag.indexOf("-")>-1||e.attrs!=null&&e.attrs.is||t!=="href"&&t!=="list"&&t!=="form"&&t!=="width"&&t!=="height")&&t in e.dom}var Ze=/[A-Z]/g;function Dt(e){return"-"+e.toLowerCase()}function ut(e){return e[0]==="-"&&e[1]==="-"?e:e==="cssFloat"?"float":e.replace(Ze,Dt)}function Vt(e,t,n){if(t!==n)if(n==null)e.style.cssText="";else if(typeof n!="object")e.style.cssText=n;else if(t==null||typeof t!="object"){e.style.cssText="";for(var c in n){var p=n[c];p!=null&&e.style.setProperty(ut(c),String(p))}}else{for(var c in n){var p=n[c];p!=null&&(p=String(p))!==String(t[c])&&e.style.setProperty(ut(c),p)}for(var c in t)t[c]!=null&&n[c]==null&&e.style.removeProperty(ut(c))}}function Pt(){this._=o}Pt.prototype=Object.create(null),Pt.prototype.handleEvent=function(e){var t=this["on"+e.type],n;typeof t=="function"?n=t.call(e.currentTarget,e):typeof t.handleEvent=="function"&&t.handleEvent(e),this._&&e.redraw!==!1&&(0,this._)(),n===!1&&(e.preventDefault(),e.stopPropagation())};function me(e,t,n){if(e.events!=null){if(e.events[t]===n)return;n!=null&&(typeof n=="function"||typeof n=="object")?(e.events[t]==null&&e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n):(e.events[t]!=null&&e.dom.removeEventListener(t.slice(2),e.events,!1),e.events[t]=void 0)}else n!=null&&(typeof n=="function"||typeof n=="object")&&(e.events=new Pt,e.dom.addEventListener(t.slice(2),e.events,!1),e.events[t]=n)}function de(e,t,n){typeof e.oninit=="function"&&m.call(e.oninit,t),typeof e.oncreate=="function"&&n.push(m.bind(e.oncreate,t))}function ge(e,t,n){typeof e.onupdate=="function"&&n.push(m.bind(e.onupdate,t))}function Ut(e,t){do{if(e.attrs!=null&&typeof e.attrs.onbeforeupdate=="function"){var n=m.call(e.attrs.onbeforeupdate,e,t);if(n!==void 0&&!n)break}if(typeof e.tag!="string"&&typeof e.state.onbeforeupdate=="function"){var n=m.call(e.state.onbeforeupdate,e,t);if(n!==void 0&&!n)break}return!1}while(!1);return e.dom=t.dom,e.domSize=t.domSize,e.instance=t.instance,e.attrs=t.attrs,e.children=t.children,e.text=t.text,!0}return function(e,t,n){if(!e)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var c=[],p=w(),_=e.namespaceURI;e.vnodes==null&&(e.textContent=""),t=ae.normalizeChildren(Array.isArray(t)?t:[t]);var L=o;try{o=typeof n=="function"?n:void 0,z(e,e.vnodes,t,c,null,_==="http://www.w3.org/1999/xhtml"?void 0:_)}finally{o=L}e.vnodes=t,p!=null&&w()!==p&&typeof p.focus=="function"&&p.focus();for(var R=0;R<c.length;R++)c[R]()}}});var _i=N((ks,ar)=>{"use strict";ar.exports=nr()(window)});var hr=N((Ts,lr)=>{"use strict";var or=_t();lr.exports=function(a,s,o){var u=[],M=!1,g=!1;function m(){if(M)throw new Error("Nested m.redraw.sync() call");M=!0;for(var x=0;x<u.length;x+=2)try{a(u[x],or(u[x+1]),w)}catch(C){o.error(C)}M=!1}function w(){g||(g=!0,s(function(){g=!1,m()}))}w.sync=m;function d(x,C){if(C!=null&&C.view==null&&typeof C!="function")throw new TypeError("m.mount(element, component) expects a component, not a vnode");var k=u.indexOf(x);k>=0&&(u.splice(k,2),a(x,[],w)),C!=null&&(u.push(x,C),a(x,or(C),w))}return{mount:d,redraw:w}}});var Be=N((Ss,cr)=>{"use strict";var Jr=_i();cr.exports=hr()(Jr,requestAnimationFrame,console)});var Ci=N((As,fr)=>{"use strict";fr.exports=function(a){if(Object.prototype.toString.call(a)!=="[object Object]")return"";var s=[];for(var o in a)u(o,a[o]);return s.join("&");function u(M,g){if(Array.isArray(g))for(var m=0;m<g.length;m++)u(M+"["+m+"]",g[m]);else if(Object.prototype.toString.call(g)==="[object Object]")for(var m in g)u(M+"["+m+"]",g[m]);else s.push(encodeURIComponent(M)+(g!=null&&g!==""?"="+encodeURIComponent(g):""))}}});var Ei=N((Ps,ur)=>{"use strict";ur.exports=Object.assign||function(a,s){s&&Object.keys(s).forEach(function(o){a[o]=s[o]})}});var Ne=N((Os,pr)=>{"use strict";var Zr=Ci(),ts=Ei();pr.exports=function(a,s){if(/:([^\/\.-]+)(\.{3})?:/.test(a))throw new SyntaxError("Template parameter names *must* be separated");if(s==null)return a;var o=a.indexOf("?"),u=a.indexOf("#"),M=u<0?a.length:u,g=o<0?M:o,m=a.slice(0,g),w={};ts(w,s);var d=m.replace(/:([^\/\.-]+)(\.{3})?/g,function(b,y,z){return delete w[y],s[y]==null?b:z?s[y]:encodeURIComponent(String(s[y]))}),x=d.indexOf("?"),C=d.indexOf("#"),k=C<0?d.length:C,T=x<0?k:x,i=d.slice(0,T);o>=0&&(i+=a.slice(o,M)),x>=0&&(i+=(o<0?"?":"&")+d.slice(x,k));var f=Zr(w);return f&&(i+=(o<0&&x<0?"?":"&")+f),u>=0&&(i+=a.slice(u)),C>=0&&(i+=(u<0?"":"&")+d.slice(C)),i}});var dr=N((Ls,mr)=>{"use strict";var es=Ne();mr.exports=function(a,s,o){var u=0;function M(w){return new s(w)}M.prototype=s.prototype,M.__proto__=s;function g(w){return function(d,x){typeof d!="string"?(x=d,d=d.url):x==null&&(x={});var C=new s(function(f,b){w(es(d,x.params),x,function(y){if(typeof x.type=="function")if(Array.isArray(y))for(var z=0;z<y.length;z++)y[z]=new x.type(y[z]);else y=new x.type(y);f(y)},b)});if(x.background===!0)return C;var k=0;function T(){--k==0&&typeof o=="function"&&o()}return i(C);function i(f){var b=f.then;return f.constructor=M,f.then=function(){k++;var y=b.apply(f,arguments);return y.then(T,function(z){if(T(),k===0)throw z}),i(y)},f}}}function m(w,d){for(var x in w.headers)if({}.hasOwnProperty.call(w.headers,x)&&d.test(x))return!0;return!1}return{request:g(function(w,d,x,C){var k=d.method!=null?d.method.toUpperCase():"GET",T=d.body,i=(d.serialize==null||d.serialize===JSON.serialize)&&!(T instanceof a.FormData),f=d.responseType||(typeof d.extract=="function"?"":"json"),b=new a.XMLHttpRequest,y=!1,z=b,$,ct=b.abort;b.abort=function(){y=!0,ct.call(this)},b.open(k,w,d.async!==!1,typeof d.user=="string"?d.user:void 0,typeof d.password=="string"?d.password:void 0),i&&T!=null&&!m(d,/^content-type$/i)&&b.setRequestHeader("Content-Type","application/json; charset=utf-8"),typeof d.deserialize!="function"&&!m(d,/^accept$/i)&&b.setRequestHeader("Accept","application/json, text/*"),d.withCredentials&&(b.withCredentials=d.withCredentials),d.timeout&&(b.timeout=d.timeout),b.responseType=f;for(var pt in d.headers)({}).hasOwnProperty.call(d.headers,pt)&&b.setRequestHeader(pt,d.headers[pt]);b.onreadystatechange=function(H){if(!y&&H.target.readyState===4)try{var I=H.target.status>=200&&H.target.status<300||H.target.status===304||/^file:\/\//i.test(w),Y=H.target.response,st;if(f==="json"?!H.target.responseType&&typeof d.extract!="function"&&(Y=JSON.parse(H.target.responseText)):(!f||f==="text")&&Y==null&&(Y=H.target.responseText),typeof d.extract=="function"?(Y=d.extract(H.target,d),I=!0):typeof d.deserialize=="function"&&(Y=d.deserialize(Y)),I)x(Y);else{try{st=H.target.responseText}catch(mt){st=Y}var Z=new Error(st);Z.code=H.target.status,Z.response=Y,C(Z)}}catch(mt){C(mt)}},typeof d.config=="function"&&(b=d.config(b,d,w)||b,b!==z&&($=b.abort,b.abort=function(){y=!0,$.call(this)})),T==null?b.send():typeof d.serialize=="function"?b.send(d.serialize(T)):T instanceof a.FormData?b.send(T):b.send(JSON.stringify(T))}),jsonp:g(function(w,d,x,C){var k=d.callbackName||"_mithril_"+Math.round(Math.random()*1e16)+"_"+u++,T=a.document.createElement("script");a[k]=function(i){delete a[k],T.parentNode.removeChild(T),x(i)},T.onerror=function(){delete a[k],T.parentNode.removeChild(T),C(new Error("JSONP request failed"))},T.src=w+(w.indexOf("?")<0?"?":"&")+encodeURIComponent(d.callbackKey||"callback")+"="+encodeURIComponent(k),a.document.documentElement.appendChild(T)})}}});var wr=N((Rs,gr)=>{"use strict";var is=xi(),rs=Be();gr.exports=dr()(window,is,rs.redraw)});var ki=N((zs,yr)=>{"use strict";yr.exports=function(a){if(a===""||a==null)return{};a.charAt(0)==="?"&&(a=a.slice(1));for(var s=a.split("&"),o={},u={},M=0;M<s.length;M++){var g=s[M].split("="),m=decodeURIComponent(g[0]),w=g.length===2?decodeURIComponent(g[1]):"";w==="true"?w=!0:w==="false"&&(w=!1);var d=m.split(/\]\[?|\[/),x=u;m.indexOf("[")>-1&&d.pop();for(var C=0;C<d.length;C++){var k=d[C],T=d[C+1],i=T==""||!isNaN(parseInt(T,10));if(k===""){var m=d.slice(0,C).join();o[m]==null&&(o[m]=Array.isArray(x)?x.length:0),k=o[m]++}else if(k==="__proto__")break;if(C===d.length-1)x[k]=w;else{var f=Object.getOwnPropertyDescriptor(x,k);f!=null&&(f=f.value),f==null&&(x[k]=f=i?[]:{}),x=f}}}return u}});var qe=N((Is,br)=>{"use strict";var ss=ki();br.exports=function(a){var s=a.indexOf("?"),o=a.indexOf("#"),u=o<0?a.length:o,M=s<0?u:s,g=a.slice(0,M).replace(/\/{2,}/g,"/");return g?(g[0]!=="/"&&(g="/"+g),g.length>1&&g[g.length-1]==="/"&&(g=g.slice(0,-1))):g="/",{path:g,params:s<0?{}:ss(a.slice(s+1,u))}}});var Mr=N((Ws,vr)=>{"use strict";var ns=qe();vr.exports=function(a){var s=ns(a),o=Object.keys(s.params),u=[],M=new RegExp("^"+s.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(g,m,w){return m==null?"\\"+g:(u.push({k:m,r:w==="..."}),w==="..."?"(.*)":w==="."?"([^/]+)\\.":"([^/]+)"+(w||""))})+"$");return function(g){for(var m=0;m<o.length;m++)if(s.params[o[m]]!==g.params[o[m]])return!1;if(!u.length)return M.test(g.path);var w=M.exec(g.path);if(w==null)return!1;for(var m=0;m<u.length;m++)g.params[u[m].k]=u[m].r?w[m+1]:decodeURIComponent(w[m+1]);return!0}}});var Er=N((Ds,Cr)=>{"use strict";var as=_t(),os=bi(),ls=xi(),hs=Ne(),xr=qe(),cs=Mr(),_r=Ei(),Ti={};Cr.exports=function(a,s){var o;function u(k,T,i){if(k=hs(k,T),o!=null){o();var f=i?i.state:null,b=i?i.title:null;i&&i.replace?a.history.replaceState(f,b,C.prefix+k):a.history.pushState(f,b,C.prefix+k)}else a.location.href=C.prefix+k}var M=Ti,g,m,w,d,x=C.SKIP={};function C(k,T,i){if(k==null)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var f=0,b=Object.keys(i).map(function(I){if(I[0]!=="/")throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(I))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:I,component:i[I],check:cs(I)}}),y=typeof setImmediate=="function"?setImmediate:setTimeout,z=ls.resolve(),$=!1,ct;if(o=null,T!=null){var pt=xr(T);if(!b.some(function(I){return I.check(pt)}))throw new ReferenceError("Default route doesn't match any known routes")}function H(){$=!1;var I=a.location.hash;C.prefix[0]!=="#"&&(I=a.location.search+I,C.prefix[0]!=="?"&&(I=a.location.pathname+I,I[0]!=="/"&&(I="/"+I)));var Y=I.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(C.prefix.length),st=xr(Y);_r(st.params,a.history.state);function Z(){if(Y===T)throw new Error("Could not resolve default route "+T);u(T,null,{replace:!0})}mt(0);function mt(K){for(;K<b.length;K++)if(b[K].check(st)){var O=b[K].component,Et=b[K].route,dt=O,ft=d=function(it){if(ft===d){if(it===x)return mt(K+1);g=it!=null&&(typeof it.view=="function"||typeof it=="function")?it:"div",m=st.params,w=Y,d=null,M=O.render?O:null,f===2?s.redraw():(f=2,s.redraw.sync())}};O.view||typeof O=="function"?(O={},ft(dt)):O.onmatch?z.then(function(){return O.onmatch(st.params,Y,Et)}).then(ft,Z):ft("div");return}Z()}}return o=function(){$||($=!0,y(H))},typeof a.history.pushState=="function"?(ct=function(){a.removeEventListener("popstate",o,!1)},a.addEventListener("popstate",o,!1)):C.prefix[0]==="#"&&(o=null,ct=function(){a.removeEventListener("hashchange",H,!1)},a.addEventListener("hashchange",H,!1)),s.mount(k,{onbeforeupdate:function(){return f=f?2:1,!(!f||Ti===M)},oncreate:H,onremove:ct,view:function(){if(!(!f||Ti===M)){var I=[as(g,m.key,m)];return M&&(I=M.render(I[0])),I}}})}return C.set=function(k,T,i){d!=null&&(i=i||{},i.replace=!0),d=null,u(k,T,i)},C.get=function(){return w},C.prefix="#!",C.Link={view:function(k){var T=k.attrs.options,i={},f,b;_r(i,k.attrs),i.selector=i.options=i.key=i.oninit=i.oncreate=i.onbeforeupdate=i.onupdate=i.onbeforeremove=i.onremove=null;var y=os(k.attrs.selector||"a",i,k.children);return(y.attrs.disabled=Boolean(y.attrs.disabled))?(y.attrs.href=null,y.attrs["aria-disabled"]="true",y.attrs.onclick=null):(f=y.attrs.onclick,b=y.attrs.href,y.attrs.href=C.prefix+b,y.attrs.onclick=function(z){var $;typeof f=="function"?$=f.call(z.currentTarget,z):f==null||typeof f!="object"||typeof f.handleEvent=="function"&&f.handleEvent(z),$!==!1&&!z.defaultPrevented&&(z.button===0||z.which===0||z.which===1)&&(!z.currentTarget.target||z.currentTarget.target==="_self")&&!z.ctrlKey&&!z.metaKey&&!z.shiftKey&&!z.altKey&&(z.preventDefault(),z.redraw=!1,C.set(b,null,T))}),y}},C.param=function(k){return m&&k!=null?m[k]:m},C}});var Tr=N((Vs,kr)=>{"use strict";var fs=Be();kr.exports=Er()(window,fs)});var wt=N((Us,Pr)=>{"use strict";var Fe=ir(),Sr=wr(),Ar=Be(),tt=function(){return Fe.apply(this,arguments)};tt.m=Fe;tt.trust=Fe.trust;tt.fragment=Fe.fragment;tt.mount=Ar.mount;tt.route=Tr();tt.render=_i();tt.redraw=Ar.redraw;tt.request=Sr.request;tt.jsonp=Sr.jsonp;tt.parseQueryString=ki();tt.buildQueryString=Ci();tt.parsePathname=qe();tt.buildPathname=Ne();tt.vnode=_t();tt.PromisePolyfill=Mi();Pr.exports=tt});var Or=N((tn,jt)=>{"use strict";var Ge=(()=>{var a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,m=Math.pow,w=(r,l,h)=>l in r?a(r,l,{enumerable:!0,configurable:!0,writable:!0,value:h}):r[l]=h,d=(r,l)=>{for(var h in l||(l={}))M.call(l,h)&&w(r,h,l[h]);if(u)for(var h of u(l))g.call(l,h)&&w(r,h,l[h]);return r},x=(r,l)=>{for(var h in l)a(r,h,{get:l[h],enumerable:!0})},C=(r,l,h,v)=>{if(l&&typeof l=="object"||typeof l=="function")for(let E of o(l))!M.call(r,E)&&E!==h&&a(r,E,{get:()=>l[E],enumerable:!(v=s(l,E))||v.enumerable});return r},k=r=>C(a({},"__esModule",{value:!0}),r),T=(r,l,h)=>{if(!l.has(r))throw TypeError("Cannot "+h)},i=(r,l,h)=>(T(r,l,"read from private field"),h?h.call(r):l.get(r)),f=(r,l,h)=>{if(l.has(r))throw TypeError("Cannot add the same private member more than once");l instanceof WeakSet?l.add(r):l.set(r,h)},b=(r,l,h,v)=>(T(r,l,"write to private field"),v?v.call(r,h):l.set(r,h),h),y=(r,l,h)=>(T(r,l,"access private method"),h),z={};x(z,{ArrayBufferTarget:()=>st,FileSystemWritableFileStreamTarget:()=>mt,Muxer:()=>zr,StreamTarget:()=>Z});var $=class{constructor(r){this.value=r}},ct=class{constructor(r){this.value=r}},pt=r=>r<1<<8?1:r<1<<16?2:r<1<<24?3:r<m(2,32)?4:r<m(2,40)?5:6,H=r=>{if(r<(1<<7)-1)return 1;if(r<(1<<14)-1)return 2;if(r<(1<<21)-1)return 3;if(r<(1<<28)-1)return 4;if(r<m(2,35)-1)return 5;if(r<m(2,42)-1)return 6;throw new Error("EBML VINT size not supported "+r)},I=(r,l,h)=>{let v=0;for(let E=l;E<h;E++){let D=Math.floor(E/8),nt=r[D],rt=7-(E&7),Ir=(nt&1<<rt)>>rt;v<<=1,v|=Ir}return v},Y=(r,l,h,v)=>{for(let E=l;E<h;E++){let D=Math.floor(E/8),nt=r[D],rt=7-(E&7);nt&=~(1<<rt),nt|=(v&1<<h-E-1)>>h-E-1<<rt,r[D]=nt}},st=class{constructor(){this.buffer=null}},Z=class{constructor(r,l,h){this.onData=r,this.onDone=l,this.options=h}},mt=class{constructor(r,l){this.stream=r,this.options=l}},K,O,Et,dt,ft,it,kt,fe,Tt,St,ue,Ht,pe=class{constructor(){f(this,Et),f(this,ft),f(this,kt),f(this,Tt),f(this,ue),this.pos=0,f(this,K,new Uint8Array(8)),f(this,O,new DataView(i(this,K).buffer)),this.offsets=new WeakMap,this.dataOffsets=new WeakMap}seek(r){this.pos=r}writeEBMLVarInt(r,l=H(r)){let h=0;switch(l){case 1:i(this,O).setUint8(h++,1<<7|r);break;case 2:i(this,O).setUint8(h++,1<<6|r>>8),i(this,O).setUint8(h++,r);break;case 3:i(this,O).setUint8(h++,1<<5|r>>16),i(this,O).setUint8(h++,r>>8),i(this,O).setUint8(h++,r);break;case 4:i(this,O).setUint8(h++,1<<4|r>>24),i(this,O).setUint8(h++,r>>16),i(this,O).setUint8(h++,r>>8),i(this,O).setUint8(h++,r);break;case 5:i(this,O).setUint8(h++,1<<3|r/m(2,32)&7),i(this,O).setUint8(h++,r>>24),i(this,O).setUint8(h++,r>>16),i(this,O).setUint8(h++,r>>8),i(this,O).setUint8(h++,r);break;case 6:i(this,O).setUint8(h++,1<<2|r/m(2,40)&3),i(this,O).setUint8(h++,r/m(2,32)|0),i(this,O).setUint8(h++,r>>24),i(this,O).setUint8(h++,r>>16),i(this,O).setUint8(h++,r>>8),i(this,O).setUint8(h++,r);break;default:throw new Error("Bad EBML VINT size "+l)}this.write(i(this,K).subarray(0,h))}writeEBML(r){var l,h;if(r!==null)if(r instanceof Uint8Array)this.write(r);else if(Array.isArray(r))for(let v of r)this.writeEBML(v);else if(this.offsets.set(r,this.pos),y(this,Tt,St).call(this,r.id),Array.isArray(r.data)){let v=this.pos,E=r.size===-1?1:(l=r.size)!=null?l:4;r.size===-1?y(this,Et,dt).call(this,255):this.seek(this.pos+E);let D=this.pos;if(this.dataOffsets.set(r,D),this.writeEBML(r.data),r.size!==-1){let nt=this.pos-D,rt=this.pos;this.seek(v),this.writeEBMLVarInt(nt,E),this.seek(rt)}}else if(typeof r.data=="number"){let v=(h=r.size)!=null?h:pt(r.data);this.writeEBMLVarInt(v),y(this,Tt,St).call(this,r.data,v)}else typeof r.data=="string"?(this.writeEBMLVarInt(r.data.length),y(this,ue,Ht).call(this,r.data)):r.data instanceof Uint8Array?(this.writeEBMLVarInt(r.data.byteLength,r.size),this.write(r.data)):r.data instanceof $?(this.writeEBMLVarInt(4),y(this,ft,it).call(this,r.data.value)):r.data instanceof ct&&(this.writeEBMLVarInt(8),y(this,kt,fe).call(this,r.data.value))}};K=new WeakMap,O=new WeakMap,Et=new WeakSet,dt=function(r){i(this,O).setUint8(0,r),this.write(i(this,K).subarray(0,1))},ft=new WeakSet,it=function(r){i(this,O).setFloat32(0,r,!1),this.write(i(this,K).subarray(0,4))},kt=new WeakSet,fe=function(r){i(this,O).setFloat64(0,r,!1),this.write(i(this,K))},Tt=new WeakSet,St=function(r,l=pt(r)){let h=0;switch(l){case 6:i(this,O).setUint8(h++,r/m(2,40)|0);case 5:i(this,O).setUint8(h++,r/m(2,32)|0);case 4:i(this,O).setUint8(h++,r>>24);case 3:i(this,O).setUint8(h++,r>>16);case 2:i(this,O).setUint8(h++,r>>8);case 1:i(this,O).setUint8(h++,r);break;default:throw new Error("Bad UINT size "+l)}this.write(i(this,K).subarray(0,h))},ue=new WeakSet,Ht=function(r){this.write(new Uint8Array(r.split("").map(l=>l.charCodeAt(0))))};var Kt,yt,Wt,At,Gt,Ze=class extends pe{constructor(r){super();f(this,At),f(this,Kt,void 0),f(this,yt,new ArrayBuffer(m(2,16))),f(this,Wt,new Uint8Array(i(this,yt))),b(this,Kt,r)}write(r){y(this,At,Gt).call(this,this.pos+r.byteLength),i(this,Wt).set(r,this.pos),this.pos+=r.byteLength}finalize(){y(this,At,Gt).call(this,this.pos),i(this,Kt).buffer=i(this,yt).slice(0,this.pos)}};Kt=new WeakMap,yt=new WeakMap,Wt=new WeakMap,At=new WeakSet,Gt=function(r){let l=i(this,yt).byteLength;for(;l<r;)l*=2;if(l===i(this,yt).byteLength)return;let h=new ArrayBuffer(l),v=new Uint8Array(h);v.set(i(this,Wt),0),b(this,yt,h),b(this,Wt,v)};var Dt,ut,Vt,Pt,me=class extends pe{constructor(r,l){super();f(this,Dt,void 0),f(this,ut,[]),f(this,Vt,0),f(this,Pt,void 0),b(this,Dt,r),b(this,Pt,l)}write(r){i(this,ut).push({data:r.slice(),start:this.pos}),this.pos+=r.byteLength}flush(){if(i(this,ut).length===0)return;let r=[],l=[...i(this,ut)].sort((h,v)=>h.start-v.start);r.push({start:l[0].start,size:l[0].data.byteLength});for(let h=1;h<l.length;h++){let v=r[r.length-1],E=l[h];E.start<=v.start+v.size?v.size=Math.max(v.size,E.start+E.data.byteLength-v.start):r.push({start:E.start,size:E.data.byteLength})}for(let h of r){h.data=new Uint8Array(h.size);for(let v of i(this,ut))h.start<=v.start&&v.start<h.start+h.size&&h.data.set(v.data,v.start-h.start);if(i(this,Pt)&&h.start<i(this,Vt))throw new Error("Internal error: Monotonicity violation.");i(this,Dt).onData(h.data,h.start),b(this,Vt,h.start+h.data.byteLength)}i(this,ut).length=0}finalize(){var r,l;(l=(r=i(this,Dt)).onDone)==null||l.call(r)}};Dt=new WeakMap,ut=new WeakMap,Vt=new WeakMap,Pt=new WeakMap;var de=m(2,24),ge=2,Ut,e,t,n,c,p,_,L,R,S,W,bt,G,j=class extends pe{constructor(r,l){var h,v;super();if(f(this,p),f(this,L),f(this,S),f(this,bt),f(this,Ut,void 0),f(this,e,void 0),f(this,t,[]),f(this,n,0),f(this,c,void 0),b(this,Ut,r),b(this,e,(v=(h=r.options)==null?void 0:h.chunkSize)!=null?v:de),b(this,c,l),!Number.isInteger(i(this,e))||i(this,e)<m(2,10))throw new Error("Invalid StreamTarget options: chunkSize must be an integer not smaller than 1024.")}write(r){y(this,p,_).call(this,r,this.pos),y(this,bt,G).call(this),this.pos+=r.byteLength}finalize(){var r,l;y(this,bt,G).call(this,!0),(l=(r=i(this,Ut)).onDone)==null||l.call(r)}};Ut=new WeakMap,e=new WeakMap,t=new WeakMap,n=new WeakMap,c=new WeakMap,p=new WeakSet,_=function(r,l){let h=i(this,t).findIndex(rt=>rt.start<=l&&l<rt.start+i(this,e));h===-1&&(h=y(this,S,W).call(this,l));let v=i(this,t)[h],E=l-v.start,D=r.subarray(0,Math.min(i(this,e)-E,r.byteLength));v.data.set(D,E);let nt={start:E,end:E+D.byteLength};if(y(this,L,R).call(this,v,nt),v.written[0].start===0&&v.written[0].end===i(this,e)&&(v.shouldFlush=!0),i(this,t).length>ge){for(let rt=0;rt<i(this,t).length-1;rt++)i(this,t)[rt].shouldFlush=!0;y(this,bt,G).call(this)}D.byteLength<r.byteLength&&y(this,p,_).call(this,r.subarray(D.byteLength),l+D.byteLength)},L=new WeakSet,R=function(r,l){let h=0,v=r.written.length-1,E=-1;for(;h<=v;){let D=Math.floor(h+(v-h+1)/2);r.written[D].start<=l.start?(h=D+1,E=D):v=D-1}for(r.written.splice(E+1,0,l),(E===-1||r.written[E].end<l.start)&&E++;E<r.written.length-1&&r.written[E].end>=r.written[E+1].start;)r.written[E].end=Math.max(r.written[E].end,r.written[E+1].end),r.written.splice(E+1,1)},S=new WeakSet,W=function(r){let h={start:Math.floor(r/i(this,e))*i(this,e),data:new Uint8Array(i(this,e)),written:[],shouldFlush:!1};return i(this,t).push(h),i(this,t).sort((v,E)=>v.start-E.start),i(this,t).indexOf(h)},bt=new WeakSet,G=function(r=!1){for(let l=0;l<i(this,t).length;l++){let h=i(this,t)[l];if(!(!h.shouldFlush&&!r)){for(let v of h.written){if(i(this,c)&&h.start+v.start<i(this,n))throw new Error("Internal error: Monotonicity violation.");i(this,Ut).onData(h.data.subarray(v.start,v.end),h.start+v.start),b(this,n,h.start+v.end)}i(this,t).splice(l--,1)}}};var Xt=class extends j{constructor(r,l){var h;super(new Z((v,E)=>r.stream.write({type:"write",data:v,position:E}),void 0,{chunkSize:(h=r.options)==null?void 0:h.chunkSize}),l)}},F=1,V=2,Q=1,U=2,Bt=m(2,15),Yt=m(2,12),we="https://github.com/Vanilagy/webm-muxer",Ot=6,Qt=5,B=["strict","offset","permissive"],P,A,vt,ot,Mt,Jt,Zt,Nt,te,Lt,ee,xt,ie,ye,Rt,zt,be,ve,Me,xe,_e,Ae,ti,Pi,ei,Oi,ii,Li,ri,Ri,si,zi,ni,Ii,ai,Wi,Pe,oi,Oe,li,hi,Di,re,Ce,qt,se,ci,Vi,fi,Ui,Le,ui,pi,Bi,It,Ft,Ee,Re,ze,mi,di,Ni,Ie,gi,We,wi,zr=class{constructor(r){f(this,ti),f(this,ei),f(this,ii),f(this,ri),f(this,si),f(this,ni),f(this,ai),f(this,Pe),f(this,Oe),f(this,hi),f(this,re),f(this,qt),f(this,ci),f(this,fi),f(this,Le),f(this,pi),f(this,It),f(this,Ee),f(this,ze),f(this,di),f(this,Ie),f(this,We),f(this,P,void 0),f(this,A,void 0),f(this,vt,void 0),f(this,ot,void 0),f(this,Mt,void 0),f(this,Jt,void 0),f(this,Zt,void 0),f(this,Nt,void 0),f(this,te,void 0),f(this,Lt,void 0),f(this,ee,void 0),f(this,xt,void 0),f(this,ie,void 0),f(this,ye,0),f(this,Rt,[]),f(this,zt,[]),f(this,be,void 0),f(this,ve,void 0),f(this,Me,-1),f(this,xe,-1),f(this,_e,void 0),f(this,Ae,!1);var l;y(this,ti,Pi).call(this,r),b(this,P,d({type:"webm",firstTimestampBehavior:"strict"},r)),this.target=r.target;let h=!!i(this,P).streaming;if(r.target instanceof st)b(this,A,new Ze(r.target));else if(r.target instanceof Z)b(this,A,((l=r.target.options)==null?void 0:l.chunked)?new j(r.target,h):new me(r.target,h));else if(r.target instanceof mt)b(this,A,new Xt(r.target,h));else throw new Error(`Invalid target: ${r.target}`);y(this,ei,Oi).call(this)}addVideoChunk(r,l,h){let v=new Uint8Array(r.byteLength);r.copyTo(v),this.addVideoChunkRaw(v,r.type,h!=null?h:r.timestamp,l)}addVideoChunkRaw(r,l,h,v){if(y(this,We,wi).call(this),!i(this,P).video)throw new Error("No video track declared.");i(this,be)===void 0&&b(this,be,h),v&&y(this,ci,Vi).call(this,v);let E=y(this,Le,ui).call(this,r,l,h,F);for(i(this,P).video.codec==="V_VP9"&&y(this,fi,Ui).call(this,E),b(this,Me,E.timestamp);i(this,zt).length>0&&i(this,zt)[0].timestamp<=E.timestamp;){let D=i(this,zt).shift();y(this,It,Ft).call(this,D)}!i(this,P).audio||E.timestamp<=i(this,xe)?y(this,It,Ft).call(this,E):i(this,Rt).push(E),y(this,re,Ce).call(this)}addAudioChunk(r,l,h){let v=new Uint8Array(r.byteLength);r.copyTo(v),this.addAudioChunkRaw(v,r.type,h!=null?h:r.timestamp,l)}addAudioChunkRaw(r,l,h,v){if(y(this,We,wi).call(this),!i(this,P).audio)throw new Error("No audio track declared.");i(this,ve)===void 0&&b(this,ve,h),(v==null?void 0:v.decoderConfig)&&(i(this,P).streaming?b(this,Lt,y(this,Ee,Re).call(this,v.decoderConfig.description)):y(this,ze,mi).call(this,i(this,Lt),v.decoderConfig.description));let E=y(this,Le,ui).call(this,r,l,h,V);for(b(this,xe,E.timestamp);i(this,Rt).length>0&&i(this,Rt)[0].timestamp<=E.timestamp;){let D=i(this,Rt).shift();y(this,It,Ft).call(this,D)}!i(this,P).video||E.timestamp<=i(this,Me)?y(this,It,Ft).call(this,E):i(this,zt).push(E),y(this,re,Ce).call(this)}finalize(){for(;i(this,Rt).length>0;)y(this,It,Ft).call(this,i(this,Rt).shift());for(;i(this,zt).length>0;)y(this,It,Ft).call(this,i(this,zt).shift());if(i(this,P).streaming||y(this,Ie,gi).call(this),i(this,A).writeEBML(i(this,ee)),!i(this,P).streaming){let r=i(this,A).pos,l=i(this,A).pos-i(this,qt,se);i(this,A).seek(i(this,A).offsets.get(i(this,vt))+4),i(this,A).writeEBMLVarInt(l,Ot),i(this,Zt).data=new ct(i(this,ye)),i(this,A).seek(i(this,A).offsets.get(i(this,Zt))),i(this,A).writeEBML(i(this,Zt)),i(this,Mt).data[0].data[1].data=i(this,A).offsets.get(i(this,ee))-i(this,qt,se),i(this,Mt).data[1].data[1].data=i(this,A).offsets.get(i(this,ot))-i(this,qt,se),i(this,Mt).data[2].data[1].data=i(this,A).offsets.get(i(this,Jt))-i(this,qt,se),i(this,A).seek(i(this,A).offsets.get(i(this,Mt))),i(this,A).writeEBML(i(this,Mt)),i(this,A).seek(r)}y(this,re,Ce).call(this),i(this,A).finalize(),b(this,Ae,!0)}};return P=new WeakMap,A=new WeakMap,vt=new WeakMap,ot=new WeakMap,Mt=new WeakMap,Jt=new WeakMap,Zt=new WeakMap,Nt=new WeakMap,te=new WeakMap,Lt=new WeakMap,ee=new WeakMap,xt=new WeakMap,ie=new WeakMap,ye=new WeakMap,Rt=new WeakMap,zt=new WeakMap,be=new WeakMap,ve=new WeakMap,Me=new WeakMap,xe=new WeakMap,_e=new WeakMap,Ae=new WeakMap,ti=new WeakSet,Pi=function(r){if(r.type&&r.type!=="webm"&&r.type!=="matroska")throw new Error(`Invalid type: ${r.type}`);if(r.firstTimestampBehavior&&!B.includes(r.firstTimestampBehavior))throw new Error(`Invalid first timestamp behavior: ${r.firstTimestampBehavior}`)},ei=new WeakSet,Oi=function(){y(this,ii,Li).call(this),i(this,P).streaming||y(this,ni,Ii).call(this),y(this,ai,Wi).call(this),y(this,ri,Ri).call(this),y(this,si,zi).call(this),i(this,P).streaming||(y(this,Pe,oi).call(this),y(this,Oe,li).call(this)),y(this,hi,Di).call(this),y(this,re,Ce).call(this)},ii=new WeakSet,Li=function(){var r;let l={id:440786851,data:[{id:17030,data:1},{id:17143,data:1},{id:17138,data:4},{id:17139,data:8},{id:17026,data:(r=i(this,P).type)!=null?r:"webm"},{id:17031,data:2},{id:17029,data:2}]};i(this,A).writeEBML(l)},ri=new WeakSet,Ri=function(){b(this,te,{id:236,size:4,data:new Uint8Array(Yt)}),b(this,Lt,{id:236,size:4,data:new Uint8Array(Yt)})},si=new WeakSet,zi=function(){b(this,Nt,{id:21936,data:[{id:21937,data:2},{id:21946,data:2},{id:21947,data:2},{id:21945,data:0}]})},ni=new WeakSet,Ii=function(){let r=new Uint8Array([28,83,187,107]),l=new Uint8Array([21,73,169,102]),h=new Uint8Array([22,84,174,107]);b(this,Mt,{id:290298740,data:[{id:19899,data:[{id:21419,data:r},{id:21420,size:5,data:0}]},{id:19899,data:[{id:21419,data:l},{id:21420,size:5,data:0}]},{id:19899,data:[{id:21419,data:h},{id:21420,size:5,data:0}]}]})},ai=new WeakSet,Wi=function(){let r={id:17545,data:new ct(0)};b(this,Zt,r);let l={id:357149030,data:[{id:2807729,data:1e6},{id:19840,data:we},{id:22337,data:we},i(this,P).streaming?null:r]};b(this,ot,l)},Pe=new WeakSet,oi=function(){let r={id:374648427,data:[]};b(this,Jt,r),i(this,P).video&&r.data.push({id:174,data:[{id:215,data:F},{id:29637,data:F},{id:131,data:Q},{id:134,data:i(this,P).video.codec},i(this,te),i(this,P).video.frameRate?{id:2352003,data:1e9/i(this,P).video.frameRate}:null,{id:224,data:[{id:176,data:i(this,P).video.width},{id:186,data:i(this,P).video.height},i(this,P).video.alpha?{id:21440,data:1}:null,i(this,Nt)]}]}),i(this,P).audio&&(b(this,Lt,i(this,P).streaming?i(this,Lt)||null:{id:236,size:4,data:new Uint8Array(Yt)}),r.data.push({id:174,data:[{id:215,data:V},{id:29637,data:V},{id:131,data:U},{id:134,data:i(this,P).audio.codec},i(this,Lt),{id:225,data:[{id:181,data:new $(i(this,P).audio.sampleRate)},{id:159,data:i(this,P).audio.numberOfChannels},i(this,P).audio.bitDepth?{id:25188,data:i(this,P).audio.bitDepth}:null]}]}))},Oe=new WeakSet,li=function(){let r={id:408125543,size:i(this,P).streaming?-1:Ot,data:[i(this,P).streaming?null:i(this,Mt),i(this,ot),i(this,Jt)]};b(this,vt,r),i(this,A).writeEBML(r)},hi=new WeakSet,Di=function(){b(this,ee,{id:475249515,data:[]})},re=new WeakSet,Ce=function(){i(this,A)instanceof me&&i(this,A).flush()},qt=new WeakSet,se=function(){return i(this,A).dataOffsets.get(i(this,vt))},ci=new WeakSet,Vi=function(r){if(!!r.decoderConfig){if(r.decoderConfig.colorSpace){let l=r.decoderConfig.colorSpace;if(b(this,_e,l),i(this,Nt).data=[{id:21937,data:{rgb:1,bt709:1,bt470bg:5,smpte170m:6}[l.matrix]},{id:21946,data:{bt709:1,smpte170m:6,"iec61966-2-1":13}[l.transfer]},{id:21947,data:{bt709:1,bt470bg:5,smpte170m:6}[l.primaries]},{id:21945,data:[1,2][Number(l.fullRange)]}],!i(this,P).streaming){let h=i(this,A).pos;i(this,A).seek(i(this,A).offsets.get(i(this,Nt))),i(this,A).writeEBML(i(this,Nt)),i(this,A).seek(h)}}r.decoderConfig.description&&(i(this,P).streaming?b(this,te,y(this,Ee,Re).call(this,r.decoderConfig.description)):y(this,ze,mi).call(this,i(this,te),r.decoderConfig.description))}},fi=new WeakSet,Ui=function(r){if(r.type!=="key"||!i(this,_e))return;let l=0;if(I(r.data,0,2)!==2)return;l+=2;let h=(I(r.data,l+1,l+2)<<1)+I(r.data,l+0,l+1);l+=2,h===3&&l++;let v=I(r.data,l+0,l+1);if(l++,v)return;let E=I(r.data,l+0,l+1);if(l++,E!==0)return;l+=2;let D=I(r.data,l+0,l+24);if(l+=24,D!==4817730)return;h>=2&&l++;let nt={rgb:7,bt709:2,bt470bg:1,smpte170m:3}[i(this,_e).matrix];Y(r.data,l+0,l+3,nt)},Le=new WeakSet,ui=function(r,l,h,v){let E=y(this,pi,Bi).call(this,h,v);return{data:r,type:l,timestamp:E,trackNumber:v}},pi=new WeakSet,Bi=function(r,l){let h=l===F?i(this,be):i(this,ve),v=l===F?i(this,Me):i(this,xe);if(i(this,P).firstTimestampBehavior==="strict"&&v===-1&&r!==0)throw new Error(`The first chunk for your media track must have a timestamp of 0 (received ${r}). Non-zero first timestamps are often caused by directly piping frames or audio data from a MediaStreamTrack into the encoder. Their timestamps are typically relative to the age of the document, which is probably what you want.

If you want to offset all timestamps of a track such that the first one is zero, set firstTimestampBehavior: 'offset' in the options.
If you want to allow non-zero first timestamps, set firstTimestampBehavior: 'permissive'.
`);if(i(this,P).firstTimestampBehavior==="offset"&&(r-=h),r<v)throw new Error(`Timestamps must be monotonically increasing (went from ${v} to ${r}).`);return r},It=new WeakSet,Ft=function(r){i(this,P).streaming&&!i(this,Jt)&&(y(this,Pe,oi).call(this),y(this,Oe,li).call(this));let l=Math.floor(r.timestamp/1e3);if(r.type!=="key"&&l-i(this,ie)>=Bt)throw new Error(`Current Matroska cluster exceeded its maximum allowed length of ${Bt} milliseconds. In order to produce a correct WebM file, you must pass in a video key frame at least every ${Bt} milliseconds.`);let v=(r.trackNumber===F||!i(this,P).video)&&r.type==="key"&&l-i(this,ie)>=1e3;(!i(this,xt)||v)&&y(this,di,Ni).call(this,l);let E=new Uint8Array(4),D=new DataView(E.buffer);D.setUint8(0,128|r.trackNumber),D.setUint16(1,l-i(this,ie),!1),D.setUint8(3,Number(r.type==="key")<<7);let nt={id:163,data:[E,r.data]};i(this,A).writeEBML(nt),b(this,ye,Math.max(i(this,ye),l))},Ee=new WeakSet,Re=function(r){return{id:25506,size:4,data:new Uint8Array(r)}},ze=new WeakSet,mi=function(r,l){let h=i(this,A).pos;i(this,A).seek(i(this,A).offsets.get(r)),r=[y(this,Ee,Re).call(this,l),{id:236,size:4,data:new Uint8Array(Yt-2-4-l.byteLength)}],i(this,A).writeEBML(r),i(this,A).seek(h)},di=new WeakSet,Ni=function(r){i(this,xt)&&!i(this,P).streaming&&y(this,Ie,gi).call(this),b(this,xt,{id:524531317,size:i(this,P).streaming?-1:Qt,data:[{id:231,data:r}]}),i(this,A).writeEBML(i(this,xt)),b(this,ie,r);let l=i(this,A).offsets.get(i(this,xt))-i(this,qt,se);i(this,ee).data.push({id:187,data:[{id:179,data:r},i(this,P).video?{id:183,data:[{id:247,data:F},{id:241,data:l}]}:null,i(this,P).audio?{id:183,data:[{id:247,data:V},{id:241,data:l}]}:null]})},Ie=new WeakSet,gi=function(){let r=i(this,A).pos-i(this,A).dataOffsets.get(i(this,xt)),l=i(this,A).pos;i(this,A).seek(i(this,A).offsets.get(i(this,xt))+4),i(this,A).writeEBMLVarInt(r,Qt),i(this,A).seek(l)},We=new WeakSet,wi=function(){if(i(this,Ae))throw new Error("Cannot add new video or audio chunks after the file has been finalized.")},k(z)})();typeof jt=="object"&&typeof jt.exports=="object"&&(jt.exports.Muxer=Ge.Muxer,jt.exports.ArrayBufferTarget=Ge.ArrayBufferTarget,jt.exports.StreamTarget=Ge.StreamTarget,jt.exports.FileSystemWritableFileStreamTarget=Ge.FileSystemWritableFileStreamTarget)});var q=gt(wt());var at=gt(wt());var Te=gt(wt()),et=class{view(s){return s.attrs.a?(0,Te.default)("a",Ve({class:`button ${s.attrs.primary?"primary":"secondary"} ${s.attrs.label?"":"icon-only"} ${s.attrs.outline?"outline":""}`},s.attrs.a),[(0,Te.default)("img",{src:`https://icongr.am/${s.attrs.iconset||"octicons"}/${s.attrs.icon}.svg?size=16&color=${s.attrs.outline?"333333":"ffffff"}`}),s.attrs.label]):(0,Te.default)("button",{class:`button ${s.attrs.primary?"primary":"secondary"} ${s.attrs.label?"":"icon-only"} ${s.attrs.outline?"outline":""}`,onclick:s.attrs.onclick,title:s.attrs.title||s.attrs.label,disabled:s.attrs.disabled},[(0,Te.default)("img",{src:`https://icongr.am/${s.attrs.iconset||"octicons"}/${s.attrs.icon}.svg?size=16&color=${s.attrs.outline?"333333":"ffffff"}`}),s.attrs.label])}};var Si=gt(wt());function us(a){let s=Math.floor(a/1e3),o=Math.floor(s/60),u=s%60,M=`${u<10?"0":""}${u}`;return`${o>0?`${o<10?"0":""}${o}`:"00"}:${M}`}var oe=class{view(s){return(0,Si.default)("span.tag.is-small",[(0,Si.default)("img",{src:"https://icongr.am/octicons/clock.svg?size=16&color=333333"}),us(s.attrs.duration)])}};var $e=gt(wt()),lt=class{view(s){return(0,$e.default)("section",{class:"view"},[(0,$e.default)("section",Ve({class:`content ${s.attrs.contentClass||""}`},s.attrs.contentProps||{}),s.children),(0,$e.default)("section",{class:"actions"},s.attrs.actions)])}};function ps(a){return a<1024?"1 KB":(a=Math.round(a/1024),a<1024?`${a} KB`:`${Math.floor(a/1024*100)/100} MB`)}function le(a,s){return String(a).padStart(s,"0")}var je=class{constructor(s){this.app=s.attrs.app,this.gif=s.attrs.gif}view(){let s=new Date,o=`Recording ${le(s.getFullYear(),4)}-${le(s.getMonth()+1,2)}-${le(s.getDate(),2)} at ${le(s.getHours(),2)}.${le(s.getMinutes(),2)}.${le(s.getSeconds(),2)}.webm`,u=[(0,at.default)(et,{label:"Download",icon:"download",a:{href:this.gif.url,download:o,target:"_blank"},primary:!0}),(0,at.default)(et,{label:"Edit",icon:"pencil",onclick:()=>this.app.editGif()}),(0,at.default)(et,{label:"Discard",icon:"trashcan",onclick:()=>this.app.discardGif()})];return[(0,at.default)(lt,{actions:u},(0,at.default)(".recording-card",[(0,at.default)("a",{href:this.gif.url,download:o,target:"_blank"},[(0,at.default)("video.recording",{src:this.gif.url,autoplay:!0})]),(0,at.default)("footer",[(0,at.default)(oe,{duration:this.gif.duration}),(0,at.default)("span.tag.is-small",[(0,at.default)("a.recording-detail",{href:this.gif.url,download:o,target:"_blank"},[(0,at.default)("img",{src:"https://icongr.am/octicons/download.svg?size=16&color=333333"}),ps(this.gif.size)])])])]))]}};var X=gt(wt());function he(a,s,o=0,u=a.length-1){let M=u-o;if(M===0)return o;if(M===1)return s<a[u].timestamp?o:u;let g=Math.floor((u+o)/2),m=a[g].timestamp;return s===m?g:s<m?he(a,s,o,g):he(a,s,g,u)}var Ai=()=>null,ht=window.devicePixelRatio||1,He=class{constructor(s){this.didDraw=!1;this.didResize=!1;var M,g;this.app=s.attrs.app,this.recording=s.attrs.recording,this.duration=this.recording.frames[this.recording.frames.length-1].timestamp+this.app.frameLength,this.mouse={x:0,y:0},this.viewport={width:0,height:0,top:0,left:0,scale:1};let o=s.attrs.renderOptions?this.recording.frames[s.attrs.renderOptions.trim.start].timestamp:0,u=s.attrs.renderOptions?this.recording.frames[s.attrs.renderOptions.trim.end].timestamp:this.duration;this.playback={head:o,start:o,offset:0,end:u,disposable:Ai},this.trim={start:o,end:u},this.crop=(g=(M=s.attrs.renderOptions)==null?void 0:M.crop)!=null?g:{top:0,left:0,width:this.recording.width,height:this.recording.height}}get isPlaying(){return this.playback.disposable!==Ai}async oncreate(s){this.sourceCanvas=s.dom.querySelector("canvas.source"),this.sourceCtx=this.sourceCanvas.getContext("2d"),this.canvas=s.dom.querySelector("canvas.target"),this.ctx=this.canvas.getContext("2d"),this.matrix=this.ctx.getTransform(),this.playbar=s.dom.querySelector(".playbar"),this.content=s.dom.querySelector(".content");let o=()=>this.onDidResize();window.addEventListener("resize",o),this.viewportDisposable=()=>window.removeEventListener("resize",o),this.onDidResize(),this.zoomToFit(),setTimeout(()=>this.play())}zoomToFit(){this.viewport.top=(this.recording.height-this.viewport.height*ht)/-2,this.viewport.left=(this.recording.width-this.viewport.width*ht)/-2,this.initialScale=Math.max(.1,Math.min(1,this.viewport.width*ht*.95/this.recording.width,this.viewport.height*ht*.95/this.recording.height))}onDidResize(){let s=Math.floor(this.content.clientWidth),o=Math.floor(this.content.clientHeight);this.viewport.left+=Math.round((s-this.viewport.width)/this.viewport.scale/2),this.viewport.top+=Math.round((o-this.viewport.height)/this.viewport.scale/2),this.viewport.width=s,this.viewport.height=o,this.didResize=!0,X.default.redraw()}onbeforeremove(){this.pause(),this.viewportDisposable()}view(){let s=[(0,X.default)(et,{title:this.isPlaying?"Pause":"Play",iconset:"material",icon:this.isPlaying?"pause":"play",primary:!0,onclick:()=>this.togglePlayPause()}),(0,X.default)(".playbar",[(0,X.default)("input",{type:"range",min:0,max:`${this.duration}`,value:`${this.playback.head}`,disabled:this.isPlaying,oninput:o=>this.onPlaybarInput(o)}),(0,X.default)(".trim-bar",{style:{left:`${this.trim.start*100/this.duration}%`,width:`${(this.trim.end-this.trim.start)*100/this.duration}%`}},[(0,X.default)(".trim-start",{onmousedown:o=>this.onTrimMouseDown("start",o)}),(0,X.default)(".trim-end",{onmousedown:o=>this.onTrimMouseDown("end",o)})])]),(0,X.default)(et,{label:"Render",icon:"gear",onclick:()=>this.startRendering(),primary:!0}),(0,X.default)(et,{title:"Discard",icon:"trashcan",onclick:()=>this.app.discardGif()})];return[(0,X.default)(lt,{actions:s,contentClass:"crop",contentProps:{onmousemove:o=>this.onMouseMove(o),onmousedown:o=>this.onMouseDown(o),oncontextmenu:o=>o.preventDefault()}},[(0,X.default)("canvas",{class:"source",width:this.recording.width,height:this.recording.height}),(0,X.default)("canvas",{class:"target",width:Math.floor(this.viewport.width*ht),height:Math.floor(this.viewport.height*ht),onwheel:o=>this.onContentWheel(o)})])]}onTrimMouseDown(s,o){o.preventDefault();let u=this.isPlaying,M=this.playback.head;this.pause();let g={width:this.playbar.clientWidth,screenX:o.screenX,head:s==="start"?this.trim.start:this.trim.end,min:s==="start"?0:this.trim.start+this.app.frameLength,max:s==="start"?this.trim.end-this.app.frameLength:this.duration},m=d=>{let x=d.screenX-g.screenX,C=g.head+Math.round(x*this.duration/g.width);this.playback.head=C,this.trim[s]=Math.max(g.min,Math.min(g.max,C)),X.default.redraw()},w=()=>{document.body.removeEventListener("mousemove",m),document.body.removeEventListener("mouseup",w),this.playback.start=this.trim.start,this.playback.end=this.trim.end,u?(this.playback.head=this.trim.start,this.play()):this.playback.head=Math.max(this.playback.start,Math.min(this.playback.end,M)),X.default.redraw()};document.body.addEventListener("mousemove",m),document.body.addEventListener("mouseup",w)}onContentWheel(s){s.preventDefault();let o=Math.pow(1.1,-s.deltaY/90);this.setScale(this.viewport.scale*o,this.mouse),this.drawFrame()}setScale(s,o={x:this.viewport.width/2,y:this.viewport.height/2}){s=Math.max(.2,Math.min(3,s));let u=s/this.viewport.scale,g=this.matrix.inverse().transformPoint({x:o.x*ht,y:o.y*ht});this.ctx.translate(g.x,g.y),this.ctx.scale(u,u),this.ctx.translate(-g.x,-g.y),this.matrix=this.ctx.getTransform(),this.viewport.scale=s}onMouseMove(s){this.mouse.x=s.clientX,this.mouse.y=s.clientY}onMouseDown(s){s.ctrlKey||s.metaKey||s.shiftKey||s.altKey||s.button>0?this.onViewportMove(s):this.onCrop(s)}onCrop(s){let o=this.matrix.inverse(),u=d=>{let x=o.transformPoint({x:d.clientX*ht,y:d.clientY*ht});return{x:Math.max(Math.min(Math.floor(x.x)-this.viewport.left,this.recording.width),0),y:Math.max(Math.min(Math.floor(x.y)-this.viewport.top,this.recording.height),0)}},M=u(s),g=!1,m=d=>{let x=u(d);this.crop.top=Math.floor(Math.max(0,Math.min(M.y,x.y))),this.crop.left=Math.floor(Math.max(0,Math.min(M.x,x.x))),this.crop.width=Math.floor(Math.min(this.recording.width-this.crop.left,Math.abs(M.x-x.x))),this.crop.height=Math.floor(Math.min(this.recording.height-this.crop.top,Math.abs(M.y-x.y))),g=!0,X.default.redraw()},w=d=>{d.preventDefault(),document.body.removeEventListener("mousemove",m),document.body.removeEventListener("mouseup",w),(!g||this.crop.width<10||this.crop.height<10)&&(this.crop.top=0,this.crop.left=0,this.crop.width=this.recording.width,this.crop.height=this.recording.height),X.default.redraw()};s.preventDefault(),document.body.addEventListener("mousemove",m),document.body.addEventListener("mouseup",w)}onViewportMove(s){let o=this.matrix.inverse(),u=w=>{let d=o.transformPoint({x:w.clientX*ht,y:w.clientY*ht});return{x:Math.floor(d.x),y:Math.floor(d.y)}},M={top:this.viewport.top,left:this.viewport.left,point:u(s)},g=w=>{let d=u(w);this.viewport.top=M.top+d.y-M.point.y,this.viewport.left=M.left+d.x-M.point.x,X.default.redraw()},m=w=>{w.preventDefault(),document.body.removeEventListener("mousemove",g),document.body.removeEventListener("mouseup",m),X.default.redraw()};s.preventDefault(),document.body.addEventListener("mousemove",g),document.body.addEventListener("mouseup",m)}onPlaybarInput(s){this.playback.head=s.target.valueAsNumber;let o=he(this.recording.frames,this.playback.head);this.ctx.putImageData(this.recording.frames[o].imageData,0,0)}play(){this.playback.disposable();let s;this.playback.head=Math.max(this.playback.start,Math.min(this.playback.end,this.playback.head)),this.playback.offset=Date.now()-this.playback.head+this.playback.start;let o=()=>{this.playback.head=this.playback.start+(Date.now()-this.playback.offset)%(this.playback.end-this.playback.start),X.default.redraw(),s=requestAnimationFrame(o)};s=requestAnimationFrame(o),this.playback.disposable=()=>cancelAnimationFrame(s)}onupdate(){this.didResize&&(this.ctx.setTransform(this.matrix),this.didResize=!1),this.drawFrame()}drawFrame(){!this.didDraw&&this.initialScale!==1&&this.setScale(this.initialScale);let s=he(this.recording.frames,this.playback.head);this.sourceCtx.putImageData(this.recording.frames[s].imageData,0,0);let o=this.ctx.getTransform();this.ctx.setTransform(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.setTransform(o),this.ctx.drawImage(this.sourceCanvas,this.viewport.left,this.viewport.top),(this.crop.top!==0||this.crop.left!==0||this.crop.width!==this.recording.width||this.crop.height!==this.recording.height)&&(this.ctx.beginPath(),this.ctx.moveTo(this.viewport.left,this.viewport.top),this.ctx.lineTo(this.viewport.left+this.recording.width,this.viewport.top),this.ctx.lineTo(this.viewport.left+this.recording.width,this.viewport.top+this.recording.height),this.ctx.lineTo(this.viewport.left,this.viewport.top+this.recording.height),this.ctx.lineTo(this.viewport.left,this.viewport.top),this.ctx.closePath(),this.ctx.moveTo(this.viewport.left+this.crop.left,this.viewport.top+this.crop.top),this.ctx.lineTo(this.viewport.left+this.crop.left,this.viewport.top+this.crop.top+this.crop.height),this.ctx.lineTo(this.viewport.left+this.crop.left+this.crop.width,this.viewport.top+this.crop.top+this.crop.height),this.ctx.lineTo(this.viewport.left+this.crop.left+this.crop.width,this.viewport.top+this.crop.top),this.ctx.lineTo(this.viewport.left+this.crop.left,this.viewport.top+this.crop.top),this.ctx.closePath(),this.ctx.fillStyle="#00000055",this.ctx.fill()),this.didDraw=!0}pause(){this.playback.disposable(),this.playback.disposable=Ai}togglePlayPause(){this.isPlaying?this.pause():this.play()}startRendering(){this.app.startRendering({trim:{start:he(this.recording.frames,this.trim.start),end:he(this.recording.frames,this.trim.end)},crop:this.crop})}};var Ct=gt(wt());var Ke=class{constructor(s){this.startTime=0;this.width=0;this.height=0;this.frames=[];this.app=s.attrs.app,this.captureStream=s.attrs.captureStream}async oncreate(s){let o=s.dom.getElementsByTagName("video")[0],u=s.dom.getElementsByTagName("canvas")[0];o.srcObject=this.captureStream;let M=u.getContext("2d"),g=new Worker("/dist/ticker.js");g.postMessage(this.app.frameLength),g.onmessage=()=>{if(o.videoWidth===0)return;let x=this.startTime===0;if(x){let k=o.videoWidth,T=o.videoHeight;this.startTime=Date.now(),this.width=k,this.height=T,u.width=k,u.height=T}M.drawImage(o,0,0);let C=M.getImageData(0,0,this.width,this.height);this.frames.push({imageData:C,timestamp:x?0:Date.now()-this.startTime})};let m=setInterval(()=>Ct.default.redraw(),this.app.frameLength),w=this.captureStream.getVideoTracks()[0],d=()=>this.stopRecording();w.addEventListener("ended",d),this._onbeforeremove=()=>{g.terminate(),clearInterval(m),w.removeEventListener("ended",d),w.stop()},Ct.default.redraw()}onbeforeremove(){this._onbeforeremove&&this._onbeforeremove()}view(){return[(0,Ct.default)(lt,[(0,Ct.default)("p",[(0,Ct.default)(oe,{duration:this.startTime===0?0:Date.now()-this.startTime})]),(0,Ct.default)(et,{label:"Stop Recording",icon:"square-fill",onclick:()=>this.stopRecording()}),(0,Ct.default)("canvas.hidden",{width:640,height:480}),(0,Ct.default)("video.hidden",{autoplay:!0,playsinline:!0})])]}stopRecording(){this.app.stopRecording({width:this.width,height:this.height,frames:this.frames})}};var Se=gt(wt()),Xe=gt(Or());var Ye=class{constructor(s){this.progress=0;this.app=s.attrs.app,this.recording=s.attrs.recording,this.renderOptions=s.attrs.renderOptions}async oncreate(s){let o=s.dom.getElementsByTagName("canvas")[0].getContext("2d"),u=new Xe.Muxer({target:new Xe.ArrayBufferTarget,video:{codec:"V_VP9",width:this.renderOptions.crop.width,height:this.renderOptions.crop.height}}),M=new VideoEncoder({output:(C,k)=>u.addVideoChunk(C,k),error:C=>console.error(C)});M.configure({codec:"vp09.00.10.08",width:this.renderOptions.crop.width,height:this.renderOptions.crop.height,bitrate:1e6});let g=this.app.frameLength*1e3;for(let C=this.renderOptions.trim.start;C<=this.renderOptions.trim.end;C++){let T=this.recording.frames[C].imageData;o.putImageData(T,0,0),T=o.getImageData(this.renderOptions.crop.left,this.renderOptions.crop.top,this.renderOptions.crop.width,this.renderOptions.crop.height);let i=await createImageBitmap(T),f=new VideoFrame(i,{timestamp:g*(C-this.renderOptions.trim.start),duration:g});M.encode(f)}await M.flush(),u.finalize();let m=u.target.buffer,w=new Blob([m]),d=window.URL.createObjectURL(w),x=this.recording.frames[this.renderOptions.trim.end].timestamp-this.recording.frames[this.renderOptions.trim.start].timestamp+this.app.frameLength;this.app.finishRendering({blob:w,url:d,duration:x,size:w.size})}view(){let s=[(0,Se.default)(et,{label:"Cancel",icon:"square-fill",onclick:()=>this.app.cancelRendering()})];return[(0,Se.default)(lt,{actions:s},[(0,Se.default)("progress",{max:"1",value:this.progress,title:"Rendering..."},`Rendering: ${Math.floor(this.progress*100)}%`),(0,Se.default)("canvas.hidden",{width:this.recording.width,height:this.recording.height})])]}};var ce=gt(wt());var Lr=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),Qe=class{constructor(s){this.app=s.attrs.app}view(){return(0,ce.default)(lt,[(0,ce.default)("p","Create animated GIFs from a screen recording."),(0,ce.default)("p","Client-side only, no data is uploaded. Modern browser required."),Lr?(0,ce.default)("p","Sorry, mobile does not support screen recording."):void 0,Lr?void 0:(0,ce.default)(et,{label:"Start Recording",icon:"play",onclick:()=>this.app.startRecording(),primary:!0})])}};var ms=12;function Je(a,s){if(a!==s)throw new Error("Invalid state")}var Rr=class{constructor(){this.frameLength=Math.floor(1e3/ms);this._state={name:"start"};window.onbeforeunload=()=>this.state.name!=="start"?"":null}get state(){return this._state}set state(s){this._state=s,q.default.redraw()}view(){return(0,q.default)("section",{id:"app",class:this.state.name==="start"?"home":""},[(0,q.default)("section",{id:"app-body"},[(0,q.default)("h1",[(0,q.default)("span",{class:"gif"},"gif"),(0,q.default)("span",{class:"cap"},"cap")]),this.body()]),(0,q.default)("footer",{id:"app-footer"},[(0,q.default)("span.left",[(0,q.default)("a",{href:"https://github.com/joaomoreno/gifcap"},[(0,q.default)("img",{alt:"GitHub",src:"https://icongr.am/octicons/mark-github.svg?size=18&color=9e9e9e"})," joaomoreno/gifcap"])]),(0,q.default)("span",[(0,q.default)("a",{title:"Sponsor me!",href:"https://github.com/sponsors/joaomoreno"},[(0,q.default)("img",{alt:"GitHub",src:"https://icongr.am/material/coffee.svg?size=18&color=9e9e9e"})," Like the tool? Sponsor me!"])]),(0,q.default)("span.right",["Made with ",(0,q.default)("img",{alt:"love",src:"https://icongr.am/octicons/heart.svg?size=18&color=9e9e9e"})," by ",(0,q.default)("a",{href:"https://github.com/joaomoreno"},["Jo\xE3o Moreno"])])])])}body(){switch(this.state.name){case"start":return(0,q.default)(Qe,{app:this});case"playing":return(0,q.default)(je,{app:this,gif:this.state.gif});case"recording":return(0,q.default)(Ke,{app:this,captureStream:this.state.captureStream});case"previewing":return(0,q.default)(He,{app:this,recording:this.state.recording,renderOptions:this.state.renderOptions});case"rendering":return(0,q.default)(Ye,{app:this,recording:this.state.recording,renderOptions:this.state.renderOptions})}}async startRecording(){try{let s=await navigator.mediaDevices.getDisplayMedia({video:{width:9999,height:9999}});this.state={name:"recording",captureStream:s},q.default.redraw.sync()}catch(s){console.error(s);return}}stopRecording(s){this.state={name:"previewing",recording:s}}startRendering(s){Je(this.state.name,"previewing"),this.state={name:"rendering",recording:this.state.recording,renderOptions:s}}finishRendering(s){Je(this.state.name,"rendering"),this.state={name:"playing",gif:s,recording:this.state.recording,renderOptions:this.state.renderOptions}}cancelRendering(){Je(this.state.name,"rendering"),this.state={name:"previewing",recording:this.state.recording,renderOptions:this.state.renderOptions}}editGif(){Je(this.state.name,"playing"),this.state={name:"previewing",recording:this.state.recording,renderOptions:this.state.renderOptions}}discardGif(){!window.confirm("This will discard the current recording, are you sure you want to continue?")||(this.state={name:"start"})}};function ds(){q.default.mount(document.getElementById("app-container"),Rr)}ds();})();
//# sourceMappingURL=main.js.map
